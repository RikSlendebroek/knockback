/*
  knockback-formatting.js
  (c) 2011-2014 Kevin Malakoff.
  Knockback is freely distributable under the MIT license.
  See the following for full license details:
    https://github.com/kmalakoff/knockback/blob/master/LICENSE
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
    Optional dependency: Backbone.ModelRef.js.
*/
(function(){var r={requires:[]};window.require&&r.requires.push(window.require),"undefined"!=typeof e&&null!==e&&r.requires.push(e),function(){"use strict";var e={},t={},n=function(r,e){return{}.hasOwnProperty.call(r,e)},i=function(r,e){var t,n,i=[];t=/^\.\.?(\/|$)/.test(e)?[r,e].join("/").split("/"):e.split("/");for(var o=0,u=t.length;u>o;o++)n=t[o],".."===n?i.pop():"."!==n&&""!==n&&i.push(n);return i.join("/")},o=function(r){return r.split("/").slice(0,-1).join("/")},u=function(e){var t=function(t){var n=o(e),u=i(n,t);return r.require(u,e)};return t.register=r.require.register,t.shim=r.require.shim,t},s=function(r,e){var n={id:r,exports:{}};return t[r]=n,e(n.exports,u(r),n),n.exports},a=function(r,o){var u=i(r,".");if(null==o&&(o="/"),n(t,u))return t[u].exports;if(n(e,u))return s(u,e[u]);var a=i(u,"./index");if(n(t,a))return t[a].exports;if(n(e,a))return s(a,e[a]);throw new Error('Cannot find module "'+r+'" from "'+o+'"')},f=function(r,t){if("object"==typeof r)for(var i in r)n(r,i)&&(e[i]=r[i]);else e[r]=t},l=Object.prototype.toString,c=function(r){return"[object Array]"===l.call(r)},p=function(e){if("undefined"!=typeof window){c(e)||(e=[e]);for(var t=function(e){var t;try{if(r.require(e.path))return}catch(n){}try{for(var i=0,o=r.requires.length;o>i&&!(t=r.requires[i](e.path));i++);}catch(n){}if(!t&&e.symbol){var u=e.symbol.split(".");t=window;for(var s=0,a=u.length;a>s&&(t=t[u[s]]);s++);}if(!t){if(e.optional)return;throw new Error("Missing dependency: "+e.path)}r.require.register(e.path,function(r,e,n){return n.exports=t}),e.alias&&r.require.register(e.alias,function(r,e,n){return n.exports=t})},n=0,i=e.length;i>n;n++)t(e[n])}};r.require=a,r.require.register=f,r.require.shim=p}.call(this);var e=r.require;e.register("formatted-observable",function(r,e,t){var n,i,o,u;try{o=e("knockback")}catch(s){i=s,o=e("./kb")}u=e("underscore"),n=Array.prototype.slice,o.toFormattedString=function(r){var e,t,i,o,s,a;s=r.slice(),t=n.call(arguments,1);for(i in t)for(e=t[i],a=ko.utils.unwrapObservable(e),(u.isUndefined(a)||u.isNull(a))&&(a=""),o=r.indexOf("{"+i+"}");o>=0;)s=s.replace("{"+i+"}",a),o=r.indexOf("{"+i+"}",o+1);return s},o.parseFormattedString=function(r,e){var t,n,i,o,s,a,f,l,c,p,d,h,b;for(p=e.slice(),i=0,a=0,l={};p.search("\\{"+i+"\\}")>=0;){for(f=e.indexOf("{"+i+"}");f>=0;)p=p.replace("{"+i+"}","(.*)"),l[f]=i,a++,f=e.indexOf("{"+i+"}",f+1);i++}if(t=i,c=new RegExp(p),s=c.exec(r),s&&s.shift(),!s||s.length!==a){for(d=[];t-->0;)d.push("");return d}b=u.sortBy(u.keys(l),function(r){return parseInt(r,10)}),n={};for(o in b)f=b[o],i=l[f],n.hasOwnProperty(i)||(n[i]=o);for(h=[],i=0;t>i;)h.push(s[n[i]]),i++;return h},t.exports=o.FormattedObservable=function(){function r(r,e){var t,i;return u.isArray(e)?(r=r,i=e):i=n.call(arguments,1),t=o.utils.wrappedObservable(this,ko.dependentObservable({read:function(){var t,n,u;for(e=[ko.utils.unwrapObservable(r)],n=0,u=i.length;u>n;n++)t=i[n],e.push(ko.utils.unwrapObservable(t));return o.toFormattedString.apply(null,e)},write:function(e){var t,n,u;for(n=o.parseFormattedString(e,ko.utils.unwrapObservable(r)),u=Math.min(i.length,n.length),t=0;u>t;)i[t](n[t]),t++}}))}return r.prototype.destroy=function(){return o.utils.wrappedDestroy(this)},r}(),o.formattedObservable=function(r){return new o.FormattedObservable(r,n.call(arguments,1))}}),e.register("index",function(r,e,t){"undefined"!=typeof window&&null!==window&&e.shim&&e.shim([{symbol:"_",path:"lodash",alias:"underscore",optional:!0},{symbol:"_",path:"underscore"},{symbol:"ko",path:"knockout"},{symbol:"kb",path:"knockback"}]),t.exports=e("./formatted-observable")}),"function"==typeof define&&define.amd?define(["require","knockback"],function(){return e("index")}):"object"==typeof exports?module.exports=e("index"):this["knockback-formatting"]=e("index")}).call(this);